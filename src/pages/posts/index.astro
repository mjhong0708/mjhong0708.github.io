---
import RootLayout from "@/layouts/RootLayout.astro";
import Container from "@/components/Container.astro";
import PostListItem from "@/components/PostListItem.astro";
import {
  getPublishedPosts,
  groupPostsByYear,
  getYearsDesc,
  sortPostsByDateDesc,
} from "@/lib/blog";

const posts = sortPostsByDateDesc(await getPublishedPosts());
const postsByYear = groupPostsByYear(posts);
const years = getYearsDesc(postsByYear);
---

<RootLayout>
  <Container>
    <div class="space-y-10">
      <h1 class="font-semibold text-2xl">Posts</h1>
      {
        years.map((year) => (
          <div class="space-y-6">
            <h2 class="font-semibold text-xl">{year}</h2>
            <div class="space-y-4">
              {postsByYear[year].map((post) => (
                <PostListItem post={post} />
              ))}
            </div>
          </div>
        ))
      }
    </div>
  </Container>
</RootLayout>
