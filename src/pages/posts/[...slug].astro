---
import Container from "@/components/Container.astro";
import PostHeader from "@/components/PostHeader.astro";
import RootLayout from "@/layouts/RootLayout.astro";
import { render } from "astro:content";
import { getPublishedPosts, sortPostsByDateDesc } from "@/lib/blog";

export async function getStaticPaths() {
  const posts = sortPostsByDateDesc(await getPublishedPosts());
  return posts.map((post) => ({
    params: { slug: post.data.slug },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await render(post);
---

<RootLayout>
  <Container>
    <PostHeader post={post} />
    <article
      class="prose max-w-none dark:prose-invert
             prose-h1:font-semibold prose-h1:text-2xl
             prose-h2:text-2xl prose-h2:font-semibold
             prose-h3:text-xl prose-h3:font-semibold
             prose-p:text-gray-800"
    >
      <article>
        <Content />
      </article>
    </article>
  </Container>
</RootLayout>
